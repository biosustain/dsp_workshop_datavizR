# For Intermediate

üìä Interactive Plots in R: plotly and ggplotly

Interactive figures are extremely useful during data **exploration** and **dashboards**.

In this section, we introduce two approaches for interactivity:

:::boxy

`ggplotly()` ‚Äî convert an existing ggplot2 plot into an interactive widget

`plotly` ‚Äî build interactive plots directly using Plotly‚Äôs own grammar
:::

### ‚≠ê `ggplotly()`: Add Interactivity to an Existing ggplot

`ggplotly()` is a converter.

It takes a normal ggplot2 object and transforms it into an interactive Plotly plot, with zooming, panning, hovering, and tooltips.

‚úî When to use `ggplotly()`

**Use it when**:

1.  You already have a ggplot and want to enhance it with interactivity.

2.  You want to keep your ggplot aesthetics, including:


>`facet_wrap`

>`themes` (theme_minimal(), theme_pubr(), etc.)

>`fill`, `color`, and `shape` aesthetics

>`scales` and `labels`

3.  You want a quick, simple solution with minimal code changes.



üîß Example

```{r, eval=TRUE}
p <- ggplot(mpg, aes(displ, hwy, color = class)) +
  geom_point(size = 3) +
  labs(
    title = "Engine Size vs Highway MPG",
    x = "Displacement",
    y = "Highway mileage"
  ) +
  theme_minimal()

ggplotly(p)
```


‚ú® Output

>Interactive scatter plot

>Hover tooltips

>Zooming, box selection, and legend toggling

>Looks almost identical to your original ggplot




### ‚≠ê `Plotly` (native): Build Interactive Plots Directly

`Plotly` also has its own plotting grammar using `plot_ly()`.

**This approach offers more control and more interactivity than converting from ggplot.**

‚úî When to use native plotly

**Use it when**:


1.  You‚Äôre creating dashboards (Shiny, Quarto).

2.  You want advanced interactivity

3.  You need performance with large datasets.


üîß Example

```{r, eval=TRUE}
plot_ly(
  data = mpg,
  x = ~displ,
  y = ~hwy,
  color = ~class,
  type = "scatter",
  mode = "markers"
)
```


::: boxy
### Exercises

Using the built-in `mpg` dataset:

1.  Make a histogram of hwy (highway fuel efficiency).
2.  Fill the bars by class.
3.  Use 30 bins.
4.  Add a title: "Highway Mileage Distribution"
5.  Apply theme_minimal().
6.  Convert your ggplot object into an interactive figure with ggplotly().

Maybe you can also try `facet_wrap(~year)`. Try to re-plot some plots we've learned before.

You can also compare it to native `plotly`
:::


## Real data


**Inspecting and summarizing the proteomics data.**


```{r}
library(readr)
library(plotly)
library(tidyverse)
```

<div class="remember">
  <strong>üìå Remember:</strong> Load the library before starting the analysis.
</div>

**Load and prepare the data**
 
`read_csv` = reads a csv file

``` {r, echo=TRUE}
data <- read_csv("../data-01/PXD040621_peptides.csv", show_col_types = FALSE)
```

<div class="remember">
  <strong>üìå Remember:</strong> Remember: You can use the `DT` package to visualize the data.
</div>

```{r}
DT::datatable(
  data = head(data, 1000),  # show only the first 1000 rows
  rownames = FALSE,
  extensions = c('Buttons', 'Scroller'),
  options = list(
    dom = 'Bfrtip',
    buttons = c('copy', 'csv'),
    deferRender = TRUE,
    scrollX = TRUE,
    scrollY = 200,
    scroller = TRUE
  ),
  caption = 'proteomics metadata'
)
```


How to load a R object

```{r}
protein_data_parsed <- readRDS("../data-01/protein_data_parsed_mut.rds")

```



```{r, echo=TRUE}
library(plotly)

p <- ggplot(protein_data_parsed_mut, aes(x = Intensity, fill = Label)) +
    geom_histogram(bins = 40, color = "white") +
    theme_minimal() +
    facet_wrap(~Reference, scales = "fixed", nrow = 2)

ggplotly(p)

```

```{r}

plot_ly(
  data = protein_data_parsed_mut,
  x = ~Intensity,
  color = ~Reference,        # equivalent to fill in ggplot2
  type = "histogram"
) %>%
  layout(
    barmode = "stack", # "overlay" or "stack"
    title = "Protein Intensity Distribution by Label",
    xaxis = list(title = "Intensity"),
    yaxis = list(title = "Count")
  )

```