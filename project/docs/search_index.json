[["introduction.html", "3 Introduction", " 3 Introduction ggplot2 is an R package for producing visualizations of data. ggplot2 uses a conceptual framework based on the grammar of graphics. More complete information about how to use ggplot2 can be found in the book. For structure, we go over the 7 composable parts that come together as a set of instructions on how to draw a chart. gplot2 needs at least the following three to produce a chart: data, a mapping, and a layer. The scales, facets, coordinates, and themes have sensible defaults that take away a lot of finicky work. In this tutorial you‚Äôll learn: About the mpg dataset included with ggplot2 The three key components of every plot: data, aesthetics and geoms How to add additional variables to a plot with aesthetics How to display additional categorical variables in a plot using small multiples created by faceting A variety of different geoms that you can use to create different types of plots How to modify the axes Save the Plot "],["data.html", "3.1 Data", " 3.1 Data As the foundation of every graphic, ggplot2 uses data to construct a plot. The system works best if the data is provided in a tidy format (we‚Äôre going to explorer it in the next section), which briefly means a rectangular data frame structure where rows are observations and columns are variables. As the first step in many plots, you would pass the data to the ggplot() function, which stores the data to be used later by other parts of the plotting system. For example, if we intend to make a graphic about the mpg dataset, we would start as follows: üìå Remember: Load the library before starting the analysis. üìò Note: You can list all the data available in ggplot with tthe following command: data(package = &quot;ggplot2&quot;) library(ggplot2) mpg ## # A tibble: 234 √ó 11 ## manufacturer model displ year cyl trans drv cty hwy fl class ## &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; ## 1 audi a4 1.8 1999 4 auto‚Ä¶ f 18 29 p comp‚Ä¶ ## 2 audi a4 1.8 1999 4 manu‚Ä¶ f 21 29 p comp‚Ä¶ ## 3 audi a4 2 2008 4 manu‚Ä¶ f 20 31 p comp‚Ä¶ ## 4 audi a4 2 2008 4 auto‚Ä¶ f 21 30 p comp‚Ä¶ ## 5 audi a4 2.8 1999 6 auto‚Ä¶ f 16 26 p comp‚Ä¶ ## 6 audi a4 2.8 1999 6 manu‚Ä¶ f 18 26 p comp‚Ä¶ ## 7 audi a4 3.1 2008 6 auto‚Ä¶ f 18 27 p comp‚Ä¶ ## 8 audi a4 quattro 1.8 1999 4 manu‚Ä¶ 4 18 26 p comp‚Ä¶ ## 9 audi a4 quattro 1.8 1999 4 auto‚Ä¶ 4 16 25 p comp‚Ä¶ ## 10 audi a4 quattro 2 2008 4 manu‚Ä¶ 4 20 28 p comp‚Ä¶ ## # ‚Ñπ 224 more rows üí° Tip: You can use the command View to visualize the data. Try it yourself. View(mpg) üß† Advanced: DT package is an excellent option to explore the metadata! Try it yourself. library(DT) #Simple datatable(head(mpg), class = &#39;cell-border stripe&#39;) #Complex DT::datatable(data = mpg, rownames = FALSE, extensions = c(&#39;Buttons&#39;, &#39;Scroller&#39;), options = list(dom = &#39;Bfrtip&#39;, buttons = c(&#39;copy&#39;, &#39;csv&#39;), deferRender = TRUE, scrollX = T, scrollX = T, scrollY = 200, scroller = TRUE, caption = &#39;mpg metadata&#39;)) mpg includes information about the fuel economy of popular car models in 1999 and 2008, collected by the US Environmental Protection Agency The variables are mostly self-explanatory: cty and hwy record miles per gallon (mpg) for city and highway driving. displ is the engine displacement in litres. drv is the drivetrain: front wheel (f), rear wheel (r) or four wheel (4). model is the model of car. There are 38 models, selected because they had a new edition every year between 1999 and 2008. class is a categorical variable describing the ‚Äútype‚Äù of car: two seater, SUV, compact, etc. This dataset suggests many interesting questions. How are engine size and fuel economy related? Do certain manufacturers care more about fuel economy than others? Has fuel economy improved in the last ten years? We will try to answer some of these questions, and in the process learn how to create some basic plots with ggplot2. 3.1.1 Understanding the grammar of the plots data ggplot(data = mpg) ‚ùì Question: Why is it empty? 3.1.2 Mapping The mapping of a plot is a set of instructions on how parts of the data are mapped onto aesthetic attributes of geometric objects. It is the ‚Äòdictionary‚Äô to translate tidy data to the graphics system. A mapping can be made by using the aes() function to make pairs of graphical attributes and parts of the data. If we want the cty and hwy columns to map to the x- and y-coordinates in the plot, we can do that as follows: ggplot(mpg, mapping = aes(x = cty, y = hwy)) 3.1.3 Layers The heart of any graphic is the layers. They take the mapped data and display it in something humans can understand as a representation of the data. Every layer consists of three important parts: The geometry that determines how data are displayed, such as points, lines, or rectangles. The statistical transformation that may compute new variables from the data and affect what of the data is displayed. The position adjustment that primarily determines where a piece of data is being displayed. A layer can be constructed using the geom_() and stat_() functions. These functions often determine one of the three parts of a layer, while the other two can still be specified. Here is how we can use two layers to display the cty and hwy columns of the mpg dataset as points and stack a trend line on top. Here‚Äôs a simple example: ggplot(mpg, aes(x = displ, y = hwy)) + geom_point() This produces a scatterplot defined by: Data: mpg. Aesthetic mapping: engine size mapped to x position, fuel economy to y position. Layer: points. Pay attention to the structure of this function call: data and aesthetic mappings are supplied in ggplot(), then layers are added on with +. ‚≠ê Important: + is an important pattern to learn This is an important pattern, and as you learn more about ggplot2 you‚Äôll construct increasingly sophisticated plots by adding on more types of components. Almost every plot maps a variable to x and y, so naming these aesthetics is tedious, so the first two unnamed arguments to aes() will be mapped to x and y. This means that the following code is identical to the example above: ggplot(mpg, aes(displ, hwy)) + geom_point() üí° Tip: Don‚Äôt forget that the first two arguments to aes() are x and y. üìò Note: Note that we‚Äôve put each command on a new line. We recommend doing this in your own code, so it‚Äôs easy to scan a plot specification and see exactly what‚Äôs there. The plot shows a strong correlation: as the engine size gets bigger, the fuel economy gets worse. There are also some interesting outliers: some cars with large engines get higher fuel economy than average. ‚ùì Question: WWhat sort of cars do you think they are? 3.1.4 Colour, size, shape and other aesthetic attributes To add additional variables to a plot, we can use other aesthetics like colour, shape, and size üí° Extra: ggplot2 accepts American and British spellings These work in the same way as the x and y aesthetics, and are added into the call to aes(): aes(displ, hwy, colour = class) aes(displ, hwy, shape = drv) aes(displ, hwy, size = cyl) ggplot2 takes care of the details of converting data (e.g., ‚Äòf‚Äô, ‚Äòr‚Äô, ‚Äò4‚Äô) into aesthetics (e.g., ‚Äòred‚Äô, ‚Äòyellow‚Äô, ‚Äògreen‚Äô) with a scale. There is one scale for each aesthetic mapping in a plot. The scale is also responsible for creating a guide, an axis or legend, that allows you to read the plot, converting aesthetic values back into data values. For now, we‚Äôll stick with the default scales provided by ggplot2. To learn more about those outlying variables in the previous scatterplot, we could map the class variable to colour: ggplot(mpg, aes(displ, hwy, colour = class)) + geom_point() This gives each point a unique colour corresponding to its class. The legend allows us to read data values from the colour, showing us that the group of cars with unusually high fuel economy for their engine size are two seaters: cars with big engines, but lightweight bodies. If you want to set an aesthetic to a fixed value, without scaling it, do so in the individual layer outside of aes(). Compare the following two plots: ggplot(mpg, aes(displ, hwy)) + geom_point(aes(colour = &quot;blue&quot;)) ggplot(mpg, aes(displ, hwy)) + geom_point(colour = &quot;blue&quot;) In the first plot, the value ‚Äúblue‚Äù is scaled to a pinkish colour, and a legend is added. In the second plot, the points are given the R colour blue. This is an important technique and you‚Äôll learn more about it in mapping See vignette(\"ggplot2-specs\") for the values needed for colour and other aesthetics. Different types of aesthetic attributes work better with different types of variables. üí° Tip: colour and shape work well with categorical variables, while size works well for continuous variables. The amount of data also makes a difference: if there is a lot of data it can be hard to distinguish different groups. An alternative solution is to use faceting, as described next. When using aesthetics in a plot, less is usually more. It‚Äôs difficult to see the simultaneous relationships among colour and shape and size, so exercise restraint when using aesthetics. Instead of trying to make one very complex plot that shows everything at once, see if you can create a series of simple plots that tell a story, leading the reader from ignorance to knowledge. 3.1.5 Facets Facets can be used to separate small multiples, or different subsets of the data. It is a powerful tool to quickly split up the data into smaller panels, based on one or more variables, to display patterns or trends (or the lack thereof) within the subsets. The facets have their own mapping that can be given as a formula. To plot subsets of the mpg dataset based on levels of the drv and year variables, we can use facet_grid() as follows: ggplot(mpg, aes(cty, hwy)) + geom_point() + facet_grid(year ~ drv) 3.1.6 Coordinates You can view the coordinates part of the plot as an interpreter of position aesthetics. While typically Cartesian coordinates are used, the coordinate system powers the display of map projections and polar plots. We can also use coordinates to display a plot with a fixed aspect ratio so that one unit has the same length in both the x and y directions. The coord_fixed() function sets this ratio automatically. ggplot(mpg, aes(cty, hwy)) + geom_point() + coord_fixed() 3.1.7 Theme The theme system controls almost any visuals of the plot that are not controlled by the data and is therefore important for the look and feel of the plot. You can use the theme for customizations ranging from changing the location of the legends to setting the background color of the plot. Many elements in the theme are hierarchical in that setting the look of the general axis line affects those of the x and y axes simultaneously. To tweak the look of the plot, one can use many of the built-in theme_() functions and/or detail specific aspects with the theme() function. The element_() functions control the graphical attributes of theme components. ggplot(mpg, aes(cty, hwy, colour = class)) + geom_point() + theme_minimal() + theme( legend.position = &quot;top&quot;, axis.line = element_line(linewidth = 0.75), axis.line.x.bottom = element_line(colour = &quot;blue&quot;) ) 3.1.8 Combining As mentioned at the start, you can layer all of the pieces to build a customized plot of your data, like the one shown at the beginning of this vignette: ggplot(mpg, aes(cty, hwy)) + geom_point(mapping = aes(colour = displ)) + geom_smooth(formula = y ~ x, method = &quot;lm&quot;) + scale_colour_viridis_c() + facet_grid(year ~ drv) + coord_fixed() + theme_minimal() + theme(panel.grid.minor = element_blank()) "],["exercises.html", "3.2 Exercises", " 3.2 Exercises "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
